import os
import sys
import shutil
from optparse import OptionParser
from creator.windows_bat_creator import create_windows_bat
from creator.windows_powershell_creator import create_windows_powershell
#from creator.linux_bash_creator import create_linux_bash
from creator.config_data import *

def create():
    parser = OptionParser()
    parser.add_option("-n", dest = "killername", default = "", help = "input your killername")
    parser.add_option("-t", dest = "script_type", default = "", help = "choose your script type, bat, powershell, bash")
    parser.add_option("-i", dest = "malware_config_id", default = "", help = 'input config malware indentified as you like:Example:"2019-03-19')
    (options, args) = parser.parse_args()

    config_datas = config(options.killername, options.malware_config_id)

    if "bat" in options.script_type:
        create_windows_bat(config_datas)
    elif "powershell" in options.script_type:
        create_windows_powershell(config_datas)
    else:
        print("[-] You Enter a wrong script type, please reenter.")
    
    return

if __name__ == '__main__':
    create()