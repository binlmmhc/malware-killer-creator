#deleted schedule tasks by execute file sha256 hash
if($deleted_schedule_task_by_execute_file_sha256){ 

    $task_root = "C:\Windows\System32\Tasks"
    $task_files = Get-ChildItem -Path $task_root -Recurse

    ForEach($task_file in $task_files){
        ForEach($malicious_task_file_hash in $malicious_task_execute_file_hashs){
            if($task_file.GetType().Name -eq "FileInfo"){ 
                $task_file_data = [XML](Get-Content $task_file.FullName)
                $task_execute_command = $task_file_data.Task.Actions.Exec.Command

                if($task_execute_command -like '"*"'){
                    $task_execute_command = $task_execute_command.Replace('"', "")
                }

                if($task_execute_command -like "%*%*"){ 
                    $task_execute_command = [System.Environment]::ExpandEnvironmentVariables($task_execute_command)
                }

                if($task_execute_command){ 
                    if(hash_and_compare -file_path $task_execute_command -compare_hash $malicious_task_file_hash){ 
                        $task_name = $task_file.Parent + "\" + $task_file.BaseName
                        if(Test-Path -Path ($task_root + "\" + $task_name)){ 
                            schtasks /Delete /TN $task_name /F
                            Write-Host "[+] Delete malicious task $malicious_task_path succesfully." -ForegroundColor Green -BackgroundColor Black
                        }
                        if(Test-Path -Path $task_execute_command){ 
                            Remove-Item -Path $task_execute_command -Confirm:$False
                            Write-Host "[+] Delete malicious task executable file $task_execute_command successfully." -ForegroundColor Green -BackgroundColor Black
                        }
                    }
                }
            }
        }
    }
}