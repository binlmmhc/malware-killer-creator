$delete_wmi_by_wmi_eventfilter_name = $True
$malicious_wmi_eventfilter_names = ( 
    "Updater"
)

if($delete_wmi_by_wmi_eventfilter_name){ 
    Try{ 
        ForEach($malicious_wmi_eventfilter_name in $malicious_wmi_eventfilter_names){
            $event_filter = Get-WmiObject -Namespace root\subscription -Class __EventFilter -Filter "Name='$malicious_wmi_eventfilter_name'"
            if($event_filter){ 
                Write-Host "[+] Delete $malicious_wmi_eventfilter_name EventFilter successfully." -ForegroundColor Green -BackgroundColor black
                $event_filter | Remove-WmiObject

                $event_consumer = Get-WmiObject -Namespace root\subscription -Class CommandLineEventConsumer -Filter "Name='$malicious_wmi_eventfilter_name'"
                if($event_consumer){ 
                    Write-Host "[+] Delete $event_consumer.__RELPATH successfully." -ForegroundColor Green -BackgroundColor black
                    $event_consumer | Remove-WmiObject
                }

                $event_filter_consumer_binder = Get-WmiObject -Namespace root\subscription -Class __FilterToConsumerBinding | Where-Object {$_.Filter -like "*$malicious_wmi_event_filter_name*"}
                if($event_filter_consumer_binder){ 
                    Write-Host "[+] Delete $malicious_wmi_eventfilter_name filter consumer binding successfully." -ForegroundColor Green -BackgroundColor black
                    $event_filter_consumer_binder | Remove-WmiObject
                }
            }
        }
    }
    Catch{ 
        Write-Host "[-] Some thing wrong while deleting wmi by name." -ForegroundColor Red -BackgroundColor black
    }
}