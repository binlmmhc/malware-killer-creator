if($delete_wmi_by_wmi_name){ 
    Try{ 
        ForEach($malicious_wmi_name in $malicious_wmi_names){
            $event_filter_binder = Get-WmiObject -Namespace root\subscription -Class __FilterToConsumerBinding | Where-Object {$_.Filter -like "*$malicious_wmi_name*"}
            $event_consumer_binder = Get-WmiObject -Namespace root\subscription -Class __FilterToConsumerBinding | Where-Object {$_.Consumer -like "*$malicious_wmi_name*"}
            $event_filter_consumer_binder = $null
            if($event_filter_binder){ 
                $event_filter_consumer_binder = $event_filter_binder
            }
            elseif($event_consumer_binder){
                $event_filter_consumer_binder = $event_consumer_binder
            }
            else{ 
                Write-Host "[*] Not Found malicious wmi $malicious_wmi_name" -ForegroundColor yellow -BackgroundColor black
                continue
            }
            Write-Host "[*] Found malicious wmi $malicious_wmi_name" -ForegroundColor Green -BackgroundColor black

            #get eventfilter_name and eventconsumer_name
            $event_filter_name = $event_filter_consumer_binder.Filter.Split('"')[1]
            $event_consumer_name = $event_filter_consumer_binder.Consumer.Split('"')[1]


            $event_filter = Get-WmiObject -Namespace root\subscription -Class __EventFilter -Filter "Name='$event_filter_name'"
            if($event_filter){ 
                Write-Host "[+] Delete $event_filter_name EventFilter successfully." -ForegroundColor Green -BackgroundColor black
                $event_filter | Remove-WmiObject
            }

            $event_consumer = Get-WmiObject -Namespace root\subscription -Class CommandLineEventConsumer -Filter "Name='$event_consumer_name'"
            if($event_consumer){ 
                Write-Host "[+] Delete $event_consumer successfully." -ForegroundColor Green -BackgroundColor black
                $event_consumer | Remove-WmiObject
            }

            Write-Host "[+] Delete $malicious_wmi_name FilterToConsumerBinding successfully." -ForegroundColor Green -BackgroundColor black
            $event_filter_consumer_binder | Remove-WmiObject
        }
    }
    Catch{ 
        Write-Host "[-] Some thing wrong while deleting wmi by name." -ForegroundColor Red -BackgroundColor black
    }
}