#delete file by filenames
if($delete_file_by_filenames){ 
    Try{ 
        ForEach($malicious_file_name in $malicious_file_names){ 
            if(Test-Path -Path $malicious_file_name){ 
                Remove-Item -Path $malicious_file_name -Confirm:$false -ErrorAction SilentlyContinue
                Write-Host "[+] Delete $malicious_file_name successfully."  -ForegroundColor Green -BackgroundColor Black
            }
        }
    }
    Catch{ 
        Write-Host "[-] Some thing wrong while delete file by name" -ForegroundColor Red -BackgroundColor Black
    }
    
}

#delete file by file namehash
if($delete_file_by_file_hash){ 
    Try{ 
        ForEach($filename in $malicious_file_namehashs.Keys){ 
            if(Test-Path -Path $filename){ 
                if(hash_and_compare -file_path $filename -compare_hash $malicious_file_namehashs[$filename]){ 
                    Remove-Item -Path $filename -Confirm:$false -ErrorAction SilentlyContinue
                    Write-Host "[+] Delete $filename by filehash successfully."  -ForegroundColor Green -BackgroundColor Black
                }
            }
        }
    }
    Catch{ 
        Write-Host "[-] Some thing wrong while delete file by file hash" -ForegroundColor Red -BackgroundColor Black
    }
}