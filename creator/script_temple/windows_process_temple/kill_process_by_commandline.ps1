if($kill_process_by_commandline){ 
    Try{ 
        $processes = Get-WmiObject -Class Win32_Process
        ForEach($process in $processes){ 
            $commandline = $process.CommandLine
            if($commandline){ 
                $commandline = $process.CommandLine.Tolower()

                ForEach($malicious_process_commandline in $malicious_process_commandlines){
                    $lower_malicious_commandline = $malicious_process_commandline.Tolower()
                    $match = $commandline -like "*$lower_malicious_commandline*"
                    if($match){ 
                        Write-Host "[*] Found malicious process " $process.Name  " with pid " $process.ProcessID -ForegroundColor Green -BackgroundColor black
                        Stop-Process  -Id $process.ProcessID -Force -Confirm:$False
                        Write-Host "[+] Kill malicious process " $process.Name " with pid " $process.ProcessID " successfully." -ForegroundColor Green -BackgroundColor black
                        break
                    }
                }
            }
        }
    }
    Catch{ 
        Write-Host "[-] Some thing wrong while killing process by commandline."
    }
}