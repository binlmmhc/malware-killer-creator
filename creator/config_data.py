import json

class config:
    def __init__(self, killername, config_time):
        
        self.killername = killername

        self.config_file = "./config/config.json"
        with open(self.config_file, "r") as config_file:
            config_data = json.load(config_file)
            try:
                self.config_data = config_data[config_time]
            except KeyError:
                print("[-] Please input a right config id")
                exit(0)

        self.deleted_filenames_filenamehashs  = self.config_data["file_be_deleted_by_name_or_hash"]
        self.deleted_regnames = self.config_data["registry_be_deleted_by_key_or_keyvalue"]
        self.deleted_tasknames = self.config_data["schedule_task_deleted_by_name_or_commandline"]
        self.deleted_services = self.config_data["service_deleted_by_name_or_filehash"]
        self.killed_processnames = self.config_data["process_be_killed_by_name_or_filehash_or_commandline"]
        self.deleted_wmi = self.config_data["wmi_deleted_by_eventfiltername_or_commandline"]

        self.all_items = {
            "registry":self.deleted_regnames,
            "schedule_task":self.deleted_tasknames,
            "services":self.deleted_services,
            "process_names":self.killed_processnames,
            "files":self.deleted_filenames_filenamehashs,
            "wmi":self.deleted_wmi
        }